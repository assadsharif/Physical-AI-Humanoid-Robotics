# Implementation Narrative: M1 Docusaurus Site

**Implementation ID**: M1-DOCUSAURUS
**Module**: Module 1 - Docusaurus Documentation
**Status**: Planning
**Created**: 2025-12-12
**Branch**: `feature/physical-ai-textbook-implement`

---

## Implementation Overview

This narrative describes HOW the Docusaurus-based textbook site will be constructed for the Physical AI & Humanoid Robotics course book. The implementation transforms the 28-chapter specification into a navigable, accessible, and pedagogically effective learning platform.

### Scope

- Docusaurus v3.x site initialization and configuration
- 6-part, 28-chapter content structure
- Custom MDX components for educational content
- Interactive elements (quizzes, glossary, diagrams)
- Accessibility compliance (WCAG 2.1 AA)
- Search integration preparation
- ChatWidget embedding point for Module 4

### Out of Scope

- Actual chapter content authoring (covered in content milestones M1.3-M1.8)
- Backend API integration (Module 3)
- RAG vector store (Module 2)
- ChatKit implementation (Module 4)

---

## Mapping to Related Specifications

### sp.specify References

| Specification | Section | Relevance |
|---------------|---------|-----------|
| `specs/physical-ai-textbook/spec.md` | Problem Statement | Defines the educational gap being addressed |
| `specs/physical-ai-textbook/spec.md` | Goals 1-6 | Maps to learning path, platform coverage, safety integration |
| `specs/physical-ai-textbook/spec.md` | FR-001 to FR-012 | Functional requirements for site structure |
| `specs/physical-ai-textbook/spec.md` | FR-013 to FR-018 | Content structure requirements by part |
| `specs/physical-ai-textbook/spec.md` | Key Entities | Chapter, Part, GlossaryTerm, Quiz, Diagram, PseudocodeBlock, SafetyCallout |
| `specs/physical-ai-textbook/spec.md` | SC-001 to SC-010 | Success criteria for measurable outcomes |
| `specs/physical-ai-textbook/spec.md` | Textbook Structure Overview | 28-chapter hierarchy |
| `.specify/memory/constitution.md` | Principle I | Spec-Driven Development compliance |
| `.specify/memory/constitution.md` | Principle II | No Vibe Coding - pseudocode only |
| `.specify/memory/constitution.md` | Principle VI | Safety-Critical Mindset |
| `.specify/memory/constitution.md` | Principle VII | Testability and Verification |

### sp.plan References

| Plan Section | Relevance |
|--------------|-----------|
| `specs/physical-ai-textbook/plan.md` | Architecture Overview | Shows M1 position in 4-module system |
| `specs/physical-ai-textbook/plan.md` | Project Structure | Defines `my-project/docs/` hierarchy |
| `specs/physical-ai-textbook/plan.md` | Phase 1 Milestones | M1.1-M1.9 milestone definitions |
| `specs/physical-ai-textbook/plan.md` | Documentation Milestones | DOC-1 through DOC-8 |
| `specs/physical-ai-textbook/plan.md` | Technical Context | Docusaurus v3.x, MDX, Mermaid dependencies |

---

## Mapping to Related Tasks

| Task ID | Task File | Implementation Phase |
|---------|-----------|---------------------|
| M1.1 | `specs/physical-ai-textbook/tasks/m1-1-site-structure.task.md` | Site Structure Setup |
| M1.2 | (To be created) | Core Components |
| M1.3 | (To be created) | Part I Content |
| M1.4 | (To be created) | Part II Content |
| M1.5 | (To be created) | Part III Content |
| M1.6 | (To be created) | Part IV Content |
| M1.7 | (To be created) | Part V Content |
| M1.8 | (To be created) | Part VI Content |
| M1.9 | (To be created) | Glossary & Index |

---

## Detailed Implementation Plan

> **Note**: This section describes conceptual execution steps. No code is provided per constitution.

### Phase 1: Foundation (M1.1)

**Objective**: Establish navigable site skeleton

**Conceptual Steps**:

1. **Environment Preparation**
   - Verify Node.js 18+ installation
   - Confirm npm/yarn package manager availability
   - Validate existing Docusaurus scaffold in `my-project/`

2. **Configuration Baseline**
   - Modify site metadata (title, tagline, URLs)
   - Configure theme with dark mode support
   - Set up navbar with primary navigation links
   - Configure footer with attribution and links

3. **Information Architecture**
   - Create 6 part-level directories under `docs/`
   - Establish chapter file naming convention (kebab-case, numbered)
   - Configure category metadata for sidebar grouping
   - Define sidebar generation strategy (autogenerated vs. explicit)

4. **Placeholder Population**
   - Generate placeholder MDX files for all 28 chapters
   - Apply consistent frontmatter template
   - Include learning objectives, prerequisites, time estimates
   - Mark content as "under development"

5. **Navigation Verification**
   - Validate all navigation paths functional
   - Test breadcrumb hierarchy
   - Confirm mobile responsiveness
   - Execute build to catch configuration errors

### Phase 2: Component Development (M1.2)

**Objective**: Create reusable MDX components for educational content

**Conceptual Steps**:

1. **Component Inventory**
   - Quiz: Multiple choice with feedback mechanism
   - GlossaryTerm: Inline term with hover/click definition
   - SafetyCallout: Prominent warning with severity levels
   - PseudocodeBlock: Styled code with disclaimer banner
   - LearningObjectives: Standardized objectives box
   - Prerequisites: Dependency list with links
   - DiagramContainer: Mermaid wrapper with fallback

2. **Component Design Principles**
   - Accessibility-first (ARIA labels, keyboard navigation)
   - Progressive enhancement (works without JavaScript)
   - Consistent styling via CSS variables
   - Responsive across breakpoints

3. **Component Integration**
   - Register components in MDX provider
   - Create usage documentation
   - Establish component props interface
   - Build Storybook or equivalent preview (optional)

4. **Styling Framework**
   - Extend Docusaurus theme with custom CSS
   - Define color palette for callout severities
   - Configure typography for readability
   - Implement print stylesheet for downloadable content

### Phase 3: Content Authoring (M1.3-M1.8)

**Objective**: Populate chapters with educational content

**Conceptual Steps per Part**:

1. **Content Planning**
   - Review chapter learning objectives from spec
   - Identify key concepts requiring diagrams
   - Plan quiz questions aligned with objectives
   - Map safety callout insertion points

2. **Content Structure**
   - Introduction with context and motivation
   - Main content sections with clear headings
   - Illustrative pseudocode (with disclaimers)
   - Diagrams using Mermaid syntax
   - Summary and key takeaways
   - Self-assessment quiz
   - Further reading references

3. **Cross-Reference Integration**
   - Link to glossary terms throughout
   - Reference prerequisite chapters
   - Connect to related concepts in other parts
   - Cite external documentation (versioned)

4. **Safety Integration**
   - Insert SafetyCallout at hazard discussion points
   - Include simulation vs. real-world disclaimers
   - Reference applicable standards (ISO, IEC)
   - Link to safety foundations chapter

5. **Review Workflow**
   - Self-review against acceptance criteria
   - Technical accuracy review by domain expert
   - Pedagogical review for learning effectiveness
   - Accessibility audit per chapter

### Phase 4: Glossary and Index (M1.9)

**Objective**: Enable term lookup and concept discovery

**Conceptual Steps**:

1. **Glossary Compilation**
   - Extract terms from all chapters
   - Write clear, concise definitions
   - Add cross-references to usage locations
   - Organize alphabetically with search support

2. **Index Generation**
   - Identify key concepts per chapter
   - Create index entries with page references
   - Group related concepts under categories
   - Enable filtering by part/topic

3. **Search Preparation**
   - Configure Docusaurus local search or Algolia placeholder
   - Ensure all content is searchable
   - Test search relevance for key terms
   - Prepare for RAG integration (Module 2)

### Phase 5: ChatWidget Integration Point (M4 Preparation)

**Objective**: Prepare embedding location for agentic chat interface

**Conceptual Steps**:

1. **Widget Placement**
   - Identify optimal UI location (floating button, sidebar)
   - Design responsive behavior across viewports
   - Plan state management for conversation persistence

2. **Context Passing**
   - Define mechanism to pass current chapter context
   - Plan URL-based or prop-based context injection
   - Design loading and error states

3. **Styling Integration**
   - Match widget styling to site theme
   - Support dark mode toggle
   - Ensure accessibility for chat interface

---

## Documentation Plan

### Docusaurus Structure Updates

| Path | Purpose | Milestone |
|------|---------|-----------|
| `my-project/docusaurus.config.ts` | Site configuration | M1.1 |
| `my-project/sidebars.ts` | Navigation structure | M1.1 |
| `my-project/docs/part-i-foundations/` | Part I chapters (4) | M1.3 |
| `my-project/docs/part-ii-humanoid-fundamentals/` | Part II chapters (4) | M1.4 |
| `my-project/docs/part-iii-ros2/` | Part III chapters (5) | M1.5 |
| `my-project/docs/part-iv-simulation/` | Part IV chapters (5) | M1.6 |
| `my-project/docs/part-v-control/` | Part V chapters (5) | M1.7 |
| `my-project/docs/part-vi-vla/` | Part VI chapters (5) | M1.8 |
| `my-project/docs/glossary/` | Glossary pages | M1.9 |
| `my-project/src/components/` | Custom MDX components | M1.2 |
| `my-project/src/css/` | Custom styling | M1.2 |

### Content Authoring Guidelines

1. **Frontmatter Requirements**
   - `sidebar_position`: Numerical ordering within part
   - `title`: Chapter title (matches spec)
   - `description`: Brief summary for SEO/preview
   - `keywords`: Array of relevant terms

2. **MDX Component Usage**
   - SafetyCallout: Use `:::warning` or custom component
   - PseudocodeBlock: Use with `ILLUSTRATIVE ONLY` header
   - Quiz: Embed at chapter end
   - GlossaryTerm: Wrap first occurrence of key terms

3. **Diagram Standards**
   - Use Mermaid for flowcharts, sequence diagrams
   - Provide alt-text for accessibility
   - Include fallback image for unsupported browsers
   - Keep diagrams simple and readable

---

## QA Plan

### Playwright Test-Spec Descriptions

| Test Category | Test ID | Description | Acceptance Criteria Reference |
|---------------|---------|-------------|-------------------------------|
| **Navigation** | NAV-001 | Verify homepage loads and displays 6 parts | AC-02, SC-001 |
| **Navigation** | NAV-002 | Verify Part I → Chapter 1 navigation | AC-03, AC-10 |
| **Navigation** | NAV-003 | Verify breadcrumb hierarchy | AC-04 |
| **Navigation** | NAV-004 | Verify search returns relevant results | SC-009 |
| **Navigation** | NAV-005 | Verify mobile menu functionality | AC-06, SC-010 |
| **Content** | CON-001 | Verify pseudocode disclaimer present | FR-007, SC-004 |
| **Content** | CON-002 | Verify glossary term tooltip | FR-005 |
| **Content** | CON-003 | Verify Mermaid diagram rendering | FR-010 |
| **Content** | CON-004 | Verify quiz feedback mechanism | FR-004 |
| **Content** | CON-005 | Verify safety callout styling | FR-008, SC-005 |
| **Accessibility** | A11Y-001 | Verify all images have alt text | FR-011 |
| **Accessibility** | A11Y-002 | Verify heading hierarchy | FR-011 |
| **Accessibility** | A11Y-003 | Verify color contrast (WCAG AA) | FR-011, SC-007 |
| **Accessibility** | A11Y-004 | Verify keyboard navigation | FR-011 |
| **Accessibility** | A11Y-005 | Verify screen reader compatibility | FR-011 |
| **Cross-Reference** | XREF-001 | Verify all internal links resolve | SC-008 |
| **Cross-Reference** | XREF-002 | Verify glossary links to chapters | SC-002 |
| **Cross-Reference** | XREF-003 | Verify index links | FR-006 |
| **Cross-Reference** | XREF-004 | Verify prerequisite links | FR-003 |

### QA Checkpoints

| Milestone | QA Gate | Blocking? |
|-----------|---------|-----------|
| M1.1 | NAV-001, NAV-002, NAV-003, NAV-005 pass | Yes |
| M1.2 | CON-001 through CON-005 pass | Yes |
| M1.3-M1.8 | Content-specific tests per part | Yes |
| M1.9 | XREF-001 through XREF-004 pass | Yes |
| Final | All A11Y tests pass, SC-007 (Lighthouse ≥90) | Yes |

### Manual QA Procedures

1. **Visual Review**
   - Check consistent styling across all chapters
   - Verify diagram readability at various zoom levels
   - Test dark mode rendering
   - Review print layout

2. **Content Accuracy**
   - Domain expert review per part
   - Verify pseudocode is illustrative only
   - Confirm safety callouts at appropriate locations
   - Check external links are valid

3. **Usability Testing**
   - Navigation path analysis (≤3 clicks to any chapter)
   - Quiz completion flow
   - Glossary lookup experience
   - Mobile usability testing

---

## Risk Analysis & Mitigations

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| **Docusaurus version incompatibility** | Medium | High | Pin exact version in package.json; test upgrade path |
| **MDX component complexity** | Medium | Medium | Start with minimal components; iterate based on feedback |
| **Accessibility failures** | Medium | High | Integrate axe-core early; continuous Lighthouse audits |
| **Content scope creep** | High | Medium | Strict adherence to spec; change requests via amendment |
| **Mermaid rendering issues** | Low | Medium | Provide static fallback images; test across browsers |
| **Mobile responsiveness gaps** | Medium | Medium | Mobile-first development; test at 375px early and often |
| **Search relevance poor** | Medium | Medium | Structured frontmatter; keyword optimization |
| **Build performance degradation** | Low | Low | Monitor build times; optimize images; lazy loading |
| **Cross-reference broken links** | High | Medium | Automated link checking in CI; XREF tests |
| **Safety callout inconsistency** | Medium | High | Callout checklist per chapter; review gate enforcement |

### Contingency Plans

1. **Docusaurus Breaking Changes**
   - Maintain version lock until migration planned
   - Document workarounds for known issues
   - Have rollback procedure ready

2. **Accessibility Non-Compliance**
   - Prioritize critical violations (keyboard, contrast)
   - Engage accessibility specialist if needed
   - Document known limitations with remediation timeline

3. **Content Delays**
   - Parts can be released incrementally
   - Placeholder content with "coming soon" messaging
   - Prioritize P1 user stories (Parts I, III)

---

## Expected Outputs & Artifacts

### Non-Code Deliverables

| Artifact | Format | Location | Milestone |
|----------|--------|----------|-----------|
| Site configuration documentation | Markdown | `specs/physical-ai-textbook/` | M1.1 |
| Component usage guide | Markdown/MDX | `my-project/docs/contributing/` | M1.2 |
| Content style guide | Markdown | `specs/physical-ai-textbook/` | M1.2 |
| Accessibility audit report | PDF/Markdown | `specs/physical-ai-textbook/qa/` | M1.9 |
| Test execution report | HTML/JSON | `e2e/reports/` | M1.9 |
| Lighthouse performance report | HTML | `specs/physical-ai-textbook/qa/` | M1.9 |
| Review sign-off checklist | Markdown | `specs/physical-ai-textbook/` | Each milestone |

### Chapter Content Artifacts (per chapter)

| Artifact | Description |
|----------|-------------|
| Learning objectives | 3-5 measurable outcomes |
| Prerequisites list | Links to required prior chapters |
| Content outline | Section headings with estimates |
| Diagram inventory | List of Mermaid diagrams needed |
| Quiz questions | 5-10 questions with answers |
| Glossary terms | New terms introduced |
| Safety callouts | Hazards and warnings identified |
| External references | Cited documentation and papers |

### Review Artifacts

| Review Type | Deliverable |
|-------------|-------------|
| Technical accuracy | Domain expert sign-off form |
| Pedagogical effectiveness | Education specialist feedback |
| Accessibility compliance | WCAG checklist completion |
| UX/Navigation | Information architect approval |

---

## Human Review Checkpoints

| Checkpoint | Reviewer | Deliverable | Blocking? |
|------------|----------|-------------|-----------|
| M1.1 Complete | UX Designer | Site structure approval | Yes |
| M1.2 Complete | Frontend Lead | Component review | Yes |
| M1.3 Complete | Domain Expert (Embodied AI) | Part I accuracy | Yes |
| M1.4 Complete | Domain Expert (Robotics) | Part II accuracy | Yes |
| M1.5 Complete | ROS2 Specialist | Part III accuracy | Yes |
| M1.6 Complete | Platform Experts | Part IV accuracy | Yes |
| M1.7 Complete | Control Systems Expert | Part V accuracy | Yes |
| M1.8 Complete | ML/AI Researcher | Part VI accuracy | Yes |
| M1.9 Complete | Technical Editor | Glossary completeness | Yes |
| Final | Accessibility Specialist | WCAG compliance | Yes |
| Final | Project Stakeholder | Launch readiness | Yes |

---

## Success Metrics

| Metric | Target | Measurement Method |
|--------|--------|-------------------|
| Navigation depth | ≤3 clicks to any chapter | Manual testing |
| Build success rate | 100% | CI pipeline |
| Lighthouse accessibility | ≥90 | Automated audit |
| Lighthouse performance | ≥90 | Automated audit |
| Broken links | 0 | Automated link checker |
| Chapters with quizzes | 100% | Content audit |
| Safety callouts per part | ≥3 | Content audit |
| Glossary term coverage | 200+ terms | Glossary count |
| Mobile responsiveness | Pass at 375px | Manual testing |

---

**Implementation Version**: 1.0.0 | **Author**: Claude Code Agent | **Reviewed**: Pending Human Approval
